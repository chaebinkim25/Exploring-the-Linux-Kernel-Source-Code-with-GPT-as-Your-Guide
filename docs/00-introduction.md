# 1장: 커널 여행의 첫걸음 - Hello, Kernel World!

> _“이 여정은 단순한 명령어의 나열이 아니다.  
> 시스템의 심장박동을 직접 느끼는 일이다.”_

---

## 1.1 우리는 왜 커널을 탐험하는가

**나:** GPT, 커널이란 정확히 뭐야?

**GPT:** "운영체제의 심장입니다. 
모든 프로그램이 실행될 때,
CPU와 메모리, 파일, 장치 사이를 중재하죠."

커널(Kernel)은 **운영체제의 핵심 부분**으로, 
하드웨어와 유저 프로그램(User Space) 사이에서
다리 역할을 합니다. 

**Gemini:** "GPT가 '심장'이라면, 저는 환상의 설계자라고 부르고 싶군요."

커널은 수많은 프로그램에게 '지금 이 컴퓨터의 주인은 바로 너야'라는 달콤한 착각을 심어줍니다. 
에 개발자는 복잡한 물리적 현실은 잊고, 오직 코드의 논리에만 집중할 수 있는 것이죠.

### 커널이 하는 일

- 메모리 관리 (Memory Management)
- 파일 시스템 (File Systems)
- 프로세스 관리 (Process Management)
- 장치 제어 (Device Drivers)
- 네트워킹 (Networking)
- 시스템 호출 인터페이스 (System Call Interface)

> 💬 **GPT의 코멘트:**  
> “커널은 눈에 보이지 않지만,  
> 당신의 모든 명령은 그를 거쳐 갑니다.”
>
> 💬 **Gemini의 코멘트:**
> "유저 프로그램이 화려한 무대라면, 커널은 그 무대를 지탱하고 조명과 음향을 조율하는 보이지 않는 스태프입니다."
> "당신은 이제 단순히 연극을 관람하는 관객의 시선을 넘어서, 시스템이라는 거대한 극장을 직접 운영하는 설계자의 시선을 갖게 될 것입니다."

`메모리`는 프로그램이 실행되는 동안 필요한 데이터를 저장하는 공간입니다. CPU는 메모리에 저장된 명령어와 데이터를 읽어와 실행합니다. `메모리 관리`는 여러 프로그램과 커널 자신이 동시에 돌아갈 때, 누가 어느 메모리를 언제, 얼마나, 어떻게 쓸지를 커널이 대신 결정하고 조절해 주는 것입니다. 메모리를 아무나 막 쓰게 두면, A 프로그램이 B 프로그램 메모리를 덮어써서 B 프로그램에 오류를 발생시키거나 보안 문제를 발생시킬 수 있고, 한 프로그램이 메모리를 무한정 점유해서 전체 시스템이 다운될 수도 있고, 실제 메모리 하드웨어보다 더 큰 프로그램은 실행하기가 어렵게 됩니다. 그래서 커널이라는 중앙 통제자가 필요하고, 커널의 역할 중 하나가 메모리 관리자입니다. 

영구 저장 장치는 프로그램이 실행되고 있든 아니든 오래 보관할 데이터를 저장하는 공간입니다. 영구 저장장치에는 많은 데이터가 저장되기 때문에 쉽게 찾고 관리할 수 있게 `파일`과 폴더 구조로 정리를 하는데, 이 정리 방식을 `파일 시스템`이라고 부릅니다. 프로그램에서 어떤 폴더에 있는 파일을 열어서 데이터를 저장하려고 할 때, 커널의 파일 시스템은 그 파일이 어떤 영구 저장장치의 어느 위치에 해당하는지를 알아낸 뒤 요청받은 데이터를 해당 위치에 기록하라고 장치에 전달합니다.

---

### 1.2 리눅스 커널의 세계지도

리눅스 커널 소스 트리는 거대한 도시와 같습니다.
각 디렉토리에는 역할이 분명히 나누어져 있죠. 

```
/init → 부팅 코드 (init/main.c)
/kernel → 스케줄러, 시그널, 프로세스 관리
/mm → 메모리 관리
/fs → 파일 시스템 (VFS, ext4 등)
/drivers → 장치 드라이버
/net → 네트워킹
/include → 전역 헤더 파일
/Documentation → 문서
/arch → CPU 종류별 코드
```

`부팅`은 컴퓨터가 전원을 켠 순간부터 운영체제가 메모리에 올라와 실행 준비를 마치기까지의 전 과정을 말합니다. 전원을 켜면, 컴퓨터의 전원관리 모듈이 안정적인 전압을 공급해줍니다. CPU는 메모리의 미리 정해진 시작 주소에서 명령어를 읽어서 펌웨어를 실행합니다. 펌웨어(firmware)는 CPU 내부 상태를 초기값으로 설정해주고, 메모리를 쓸 수 있는 상태로 만들어주고, GPU, SSD, 하드디스크, USB 장치가 CPU와 원활하게 통신할 수 있게 세팅을 하고, 초기 설정에 필요한 최소한의 키보드/화면을 제공하고, 실제로 커널을 메모리에 불러오는 부트로더(bootloader)를 실행합니다. 부트로더는 SSD, 하드디스크 등과 통신하는 프로그램과 파일 시스템을 제공하여 커널 프로그램을 읽어서 적절한 메모리 위치에 저장하고, 커널을 실행합니다. 커널에서 가장 먼저 실행되는 코드는 `/arch`에 있는 CPU 종류별 초기 코드로, 메모리 주소 부여, CPU 설정 등을 합니다. 그리고 커널을 시작하는 `start_kernel()` 함수를 호출하는데, 이 함수가 `/init/main.c` 파일에 있습니다. `start_kernel()` 함수는 부팅 메시지가 화면에 보일 수 있게 해주고, 커널의 각종 기능들을 초기화합니다. 






📘 **비유하자면:**  
- `init/`은 입국심사대,  
- `mm/`은 메모리 행성,  
- `fs/`는 데이터의 바다,  
- `drivers/`는 하드웨어의 정글입니다.

> 💬 **GPT의 코멘트:**  
> “이 지도를 익히면,  
> 나중에 특정 기능이 ‘어디에 살고 있는지’  
> 직감적으로 찾을 수 있게 됩니다.”

---

### 1.3 커널과 유저의 경계

| 영역 | 설명 | 예시 |
|------|------|------|
| **User Mode** | 어플리케이션이 실행되는 공간 | `bash`, `vim`, `gcc` |
| **Kernel Mode** | 시스템 자원을 직접 다루는 영역 | `sys_open()`, `do_fork()` |
| **경계** | 시스템 콜(System Call) | `write(1, "hi", 2)` → `sys_write()` |

`bash`는 명령어 해석기입니다. 사용자가 터미널에 입력한 명령을 읽고 그에 따라 내장된 기능을 수행하거나 다른 프로그램을 실행합니다. 예를 들어, ls라고 입력하면 ls라는 프로그램을 찾아서 실행하고, 현재 폴더의 내용이 출력됩니다.

`vim`은 텍스트 편집기입니다. 파일을 열고, 내용을 읽고, 저장할 때 시스템 콜을 통해 커널의 도움을 받습니다.


### GPT를 활용한 코드 탐색

GPT(Generative Pre-trained Transformer)를 활용하면 복잡한 커널 코드를 더 쉽게 이해할 수 있습니다:

1. **코드 설명 요청**: 특정 함수나 코드 블록의 의미를 물어볼 수 있습니다
2. **디버깅 지원**: 버그를 찾거나 코드의 문제점을 파악하는 데 도움을 받을 수 있습니다
3. **학습 가이드**: 단계별로 학습할 내용을 추천받을 수 있습니다
4. **코드 예제**: 특정 개념을 설명하는 예제 코드를 생성할 수 있습니다

### 이 책의 활용 방법

1. **순차적 학습**: 장을 순서대로 읽으며 체계적으로 학습합니다
2. **실습 중심**: 각 장의 예제를 직접 실행하고 수정해봅니다
3. **GPT 활용**: 이해가 안 되는 부분은 GPT에게 질문합니다
4. **커뮤니티 참여**: GitHub Issues를 통해 질문하고 토론합니다

### 개발 환경 설정

리눅스 커널을 학습하기 위해서는 다음과 같은 환경이 필요합니다:

#### 필수 도구

```bash
# Ubuntu/Debian 기반
sudo apt-get update
sudo apt-get install build-essential libncurses-dev bison flex libssl-dev libelf-dev

# 커널 소스 다운로드
git clone https://github.com/torvalds/linux.git
cd linux

# 브랜치 확인
git branch -a
```

#### 추천 도구

- **Code Editor**: Visual Studio Code, Vim, Emacs
- **Debugger**: GDB, KGDB
- **Virtual Machine**: QEMU, VirtualBox
- **Documentation Tools**: Doxygen, Sphinx

### 다음 장에서는...

다음 장에서는 리눅스 커널의 전체 아키텍처를 살펴보고, 각 구성 요소가 어떻게 상호작용하는지 알아봅니다.

---

[다음: 커널 아키텍처 개요 →](01-kernel-architecture.md)
